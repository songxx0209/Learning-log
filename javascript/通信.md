---
title: 前端通信
---



### 什么是通源策略及限制

协议、域名、端口相同

- Cookie、LocalStorage和IndexDB 无法读取
- DOM无法获取
- AJAX请求不能发送



### 前后端如何通信

- Ajax
- WebSocket  // 没有同源策略的影响
- CORS
- Jsonp



### 如何创建一个Ajax

- XMLHttpRequest对象的工作流程
- 兼容性处理
- 事件的触发条件
- 事件的触发顺序



### 跨域通信方式

- JSONP
- Hash
- postMessage
- WebSocket
- CORS
- 服务端代理
- window.name



**jsonp**

1、一个众所周知的问题，Ajax直接请求普通文件存在跨域无权限访问的问题，甭管你是静态页面、动态网页、web服务、WCF，只要是跨域请求，一律不准；

2、Web页面上调用js文件时则不受是否跨域的影响（不仅如此，凡是拥有"src"这个属性的标签都拥有跨域的能力，比如`<script>`、`<img>`、`<iframe>`）

3、web客户端通过与调用脚本一模一样的方式，来调用跨域服务器上动态生成的js格式文件（一般以JSON为后缀），服务器之所以要动态生成JSON文件，目的就在于把客户端需要的数据装入进去。

4、这种获取远程数据的方式看起来非常像AJAX，但其实并不一样。

5、为了便于客户端使用数据，逐渐形成了一种非正式传输协议，人们把它称作JSONP。

6、该协议的一个要点就是允许用户传递一个callback参数给服务端，然后服务端返回数据时会将这个callback参数作为函数名来包裹住JSON数据，这样客户端就可以随意定制自己的函数来自动处理返回数据了。

**jsonp的原理：**

**jsonp缺点:**

1. jsonp只支持get请求而不支持post请求,也即是说如果想传给后台一个json格式的数据,此时问题就来了,浏览器会报一个http状态码415错误,告诉你请求格式不正确,这让我很蛋疼(在登录注册中需要给后台传一大串数据),如果都用参数的形式拼接在url后面的话不太现实,后台取值也会显得繁琐,

2. 在登录模块中需要用到session来判断当前用户的登录状态,这时候由于是跨域的原因,前后台的取到的session是不一样的,那么就不能就行session来判断.

3. 由于jsonp存在安全性问题(不知qq空间的跨域是怎么解决的,还是另有高招?) 

   **jsonp有什么安全问题？**

   JSONP漏洞点主要有：callback参数注入、资源访问授权设置！